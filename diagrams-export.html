<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Flow Diagrams - White Box Testing</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 40px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #555;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .diagram-section {
            margin-bottom: 60px;
            page-break-after: always;
        }
        .metrics {
            background: #f9f9f9;
            padding: 20px;
            border-left: 4px solid #4CAF50;
            margin: 20px 0;
        }
        .metrics h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .paths {
            background: #fff;
            padding: 15px;
            border: 1px solid #ddd;
            margin-top: 10px;
        }
        .paths ol {
            margin: 10px 0;
            padding-left: 25px;
        }
        .paths li {
            margin: 8px 0;
            line-height: 1.6;
        }
        .mermaid {
            text-align: center;
            margin: 30px 0;
        }
        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
            .diagram-section {
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Control Flow Diagrams - White Box Testing Analysis</h1>
        <p><strong>Project:</strong> Food Waste Reduction Platform</p>
        <p><strong>Date:</strong> November 2, 2025</p>

        <!-- Diagram 1: Vendor Sign Up -->
        <div class="diagram-section">
            <h2>1. Vendor Sign Up + License Upload</h2>
            
            <div class="mermaid">
graph TD
    Start([1. Start]) --> Input[2. Enter Email/Password]
    Input --> ValidEmail{3. Valid Email & Password Format?}
    ValidEmail -->|No| ErrorEmail[4. Error: Invalid email format or Password must be at least 6 characters]
    ErrorEmail --> End1([End])
    
    ValidEmail -->|Yes| SecQ[5. Select Security Questions & Answers]
    SecQ --> ValidSecQ{6. All 3 Questions Selected & Answered?}
    ValidSecQ -->|No| ErrorSecQ[7. Error: Please complete all security questions]
    ErrorSecQ --> End2([End])
    
    ValidSecQ -->|Yes| CreateUser[8. Create User Account]
    CreateUser --> UserSuccess{9. Account Created?}
    UserSuccess -->|No| ErrorUser[10. Error: Email already registered or server error]
    ErrorUser --> End3([End])
    
    UserSuccess -->|Yes| FileSelect[11. Select License File]
    FileSelect --> FileValid{12. File Selected & Valid?}
    FileValid -->|No| ErrorFile[13. Error: Please select a file to upload]
    ErrorFile --> End4([End])
    
    FileValid -->|Yes| Upload[14. Upload to Storage]
    Upload --> UploadSuccess{15. Upload Successful?}
    UploadSuccess -->|No| ErrorUpload[16. Error: Failed to upload file]
    ErrorUpload --> End5([End])
    
    UploadSuccess -->|Yes| SaveDB[17. Save License Data to Database]
    SaveDB --> DBSuccess{18. Data Saved?}
    DBSuccess -->|No| ErrorDB[19. Error: Failed to submit license]
    ErrorDB --> End6([End])
    
    DBSuccess -->|Yes| Success[20. Navigate to License Pending Page]
    Success --> End7([End])
            </div>

            <div class="metrics">
                <h3>Cyclomatic Complexity: 9</h3>
                <p><strong>Formula:</strong> V(G) = E - N + 2P</p>
                <p>Where E = edges, N = nodes, P = connected components</p>
                
                <div class="paths">
                    <h4>Basis Paths (9 independent paths):</h4>
                    <ol>
                        <li><strong>Path 1:</strong> 1 → 2 → 3 → 4 → End (Invalid email/password format)</li>
                        <li><strong>Path 2:</strong> 1 → 2 → 3 → 5 → 6 → 7 → End (Incomplete security questions)</li>
                        <li><strong>Path 3:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 10 → End (User creation failed)</li>
                        <li><strong>Path 4:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → 13 → End (No file selected)</li>
                        <li><strong>Path 5:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → 14 → 15 → 16 → End (Upload failed)</li>
                        <li><strong>Path 6:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → 14 → 15 → 17 → 18 → 19 → End (Database save failed)</li>
                        <li><strong>Path 7:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → 14 → 15 → 17 → 18 → 20 → End (Success)</li>
                        <li><strong>Path 8:</strong> 1 → 2 → 3 → 4 (from ValidEmail) → ErrorEmail → End</li>
                        <li><strong>Path 9:</strong> 1 → 2 → 3 → 5 → 6 → 7 (from ValidSecQ) → ErrorSecQ → End</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Diagram 2: Create Food Listing -->
        <div class="diagram-section">
            <h2>2. Create Food Listing (Vendor)</h2>
            
            <div class="mermaid">
graph TD
    Start([1. Start]) --> CheckAuth[2. Check User Authentication]
    CheckAuth --> IsAuth{3. User Authenticated?}
    IsAuth -->|No| ErrorAuth[4. Error: Redirect to Login]
    ErrorAuth --> End1([End])
    
    IsAuth -->|Yes| CheckActive[5. Check Active Listings Count]
    CheckActive --> HasSpace{6. Less than 5 Active Listings?}
    HasSpace -->|No| ErrorLimit[7. Error: Maximum 5 active listings reached]
    ErrorLimit --> End2([End])
    
    HasSpace -->|Yes| FillForm[8. Fill Form: Title, Description, Location, Quantity, Best Before]
    FillForm --> ValidTitle{9. Title Provided?}
    ValidTitle -->|No| ErrorTitle[10. Error: Title is required]
    ErrorTitle --> End3([End])
    
    ValidTitle -->|Yes| ValidDesc{11. Description Provided?}
    ValidDesc -->|No| ErrorDesc[12. Error: Description is required]
    ErrorDesc --> End4([End])
    
    ValidDesc -->|Yes| ValidLoc{13. Location Provided?}
    ValidLoc -->|No| ErrorLoc[14. Error: Location is required]
    ErrorLoc --> End5([End])
    
    ValidLoc -->|Yes| ValidDate{15. Valid Best Before Date?}
    ValidDate -->|No| ErrorDate[16. Error: Best before date must be in the future]
    ErrorDate --> End6([End])
    
    ValidDate -->|Yes| ValidImg{17. Image Uploaded?}
    ValidImg -->|No| ErrorImg[18. Error: Please add at least one image]
    ErrorImg --> End7([End])
    
    ValidImg -->|Yes| Submit[19. Submit to Database]
    Submit --> DBSuccess{20. Listing Created?}
    DBSuccess -->|No| ErrorDB[21. Error: Failed to create listing]
    ErrorDB --> End8([End])
    
    DBSuccess -->|Yes| Success[22. Navigate to Dashboard with Success Toast]
    Success --> End9([End])
            </div>

            <div class="metrics">
                <h3>Cyclomatic Complexity: 11</h3>
                <p><strong>Formula:</strong> V(G) = E - N + 2P</p>
                
                <div class="paths">
                    <h4>Basis Paths (10 independent paths):</h4>
                    <ol>
                        <li><strong>Path 1:</strong> 1 → 2 → 3 → 4 → End (Not authenticated)</li>
                        <li><strong>Path 2:</strong> 1 → 2 → 3 → 5 → 6 → 7 → End (Listing limit reached)</li>
                        <li><strong>Path 3:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 10 → End (No title)</li>
                        <li><strong>Path 4:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → End (No description)</li>
                        <li><strong>Path 5:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 14 → End (No location)</li>
                        <li><strong>Path 6:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 15 → 16 → End (Invalid date)</li>
                        <li><strong>Path 7:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 15 → 17 → 18 → End (No image)</li>
                        <li><strong>Path 8:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 15 → 17 → 19 → 20 → 21 → End (DB error)</li>
                        <li><strong>Path 9:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 15 → 17 → 19 → 20 → 22 → End (Success)</li>
                        <li><strong>Path 10:</strong> Additional edge coverage paths through decision nodes</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Diagram 3: Consumer Scan QR -->
        <div class="diagram-section">
            <h2>3. Consumer Scan QR + Collect Food</h2>
            
            <div class="mermaid">
graph TD
    Start([1. Start]) --> CheckLogin[2. Check User Login]
    CheckLogin --> IsLoggedIn{3. User Logged In?}
    IsLoggedIn -->|No| ErrorLogin[4. Error: Please log in to scan QR codes]
    ErrorLogin --> End1([End])
    
    IsLoggedIn -->|Yes| ScanQR[5. Scan QR Code]
    ScanQR --> ValidQR{6. Valid QR Code Format?}
    ValidQR -->|No| ErrorQR[7. Error: Invalid QR code]
    ErrorQR --> End2([End])
    
    ValidQR -->|Yes| ServerValidate[8. Server: Validate QR Code]
    ServerValidate --> QRExists{9. QR Code Exists in DB?}
    QRExists -->|No| ErrorNotFound[10. Error: Invalid or expired QR code]
    ErrorNotFound --> End3([End])
    
    QRExists -->|Yes| CheckListing{11. Listing Active & Available?}
    CheckListing -->|No| ErrorListing[12. Error: This listing is no longer available]
    ErrorListing --> End4([End])
    
    CheckListing -->|Yes| CheckRole{13. User Role?}
    CheckRole -->|Consumer| CheckDaily[14. Check Daily Limit]
    CheckDaily --> UnderLimit{15. Under Daily Limit 5 portions?}
    UnderLimit -->|No| ErrorDaily[16. Error: Daily collection limit reached 5 per day]
    ErrorDaily --> End5([End])
    
    UnderLimit -->|Yes| CheckPortions{17. Sufficient Portions Available?}
    CheckPortions -->|No| ErrorPortions[18. Error: Not enough portions available]
    ErrorPortions --> End6([End])
    
    CheckPortions -->|Yes| CollectConsumer[19. Mark as Collected & Create Collection Record]
    CollectConsumer --> UpdatePortions1[20. Update Available Portions]
    UpdatePortions1 --> Success1[21. Success Toast: Food collected successfully]
    Success1 --> End7([End])
    
    CheckRole -->|Charitable Org| CheckOrgReserve{22. Has Organization Reservation?}
    CheckOrgReserve -->|No| ErrorOrgReserve[23. Error: Organization must reserve first]
    ErrorOrgReserve --> End8([End])
    
    CheckOrgReserve -->|Yes| CheckDeposit{24. Deposit Paid?}
    CheckDeposit -->|No| ErrorDeposit[25. Error: Deposit payment required]
    ErrorDeposit --> End9([End])
    
    CheckDeposit -->|Yes| CheckAlready{26. Already Collected?}
    CheckAlready -->|Yes| ErrorAlready[27. Error: Reservation already collected]
    ErrorAlready --> End10([End])
    
    CheckAlready -->|No| CheckOrgPortions{28. Sufficient Portions for Reservation?}
    CheckOrgPortions -->|No| ErrorOrgPortions[29. Error: Not enough portions available]
    ErrorOrgPortions --> End11([End])
    
    CheckOrgPortions -->|Yes| CollectOrg[30. Mark Reservation as Collected]
    CollectOrg --> UpdatePortions2[31. Update Available Portions]
    UpdatePortions2 --> Success2[32. Success Toast: Collected for distribution]
    Success2 --> End12([End])
            </div>

            <div class="metrics">
                <h3>Cyclomatic Complexity: 13</h3>
                <p><strong>Formula:</strong> V(G) = E - N + 2P</p>
                
                <div class="paths">
                    <h4>Basis Paths (13 independent paths):</h4>
                    <ol>
                        <li><strong>Path 1:</strong> 1 → 2 → 3 → 4 → End (Not logged in)</li>
                        <li><strong>Path 2:</strong> 1 → 2 → 3 → 5 → 6 → 7 → End (Invalid QR format)</li>
                        <li><strong>Path 3:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 10 → End (QR not found)</li>
                        <li><strong>Path 4:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 12 → End (Listing unavailable)</li>
                        <li><strong>Path 5:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 14 → 15 → 16 → End (Consumer daily limit)</li>
                        <li><strong>Path 6:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 14 → 15 → 17 → 18 → End (Consumer insufficient portions)</li>
                        <li><strong>Path 7:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 14 → 15 → 17 → 19 → 20 → 21 → End (Consumer success)</li>
                        <li><strong>Path 8:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 22 → 23 → End (Org no reservation)</li>
                        <li><strong>Path 9:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 22 → 24 → 25 → End (Org no deposit)</li>
                        <li><strong>Path 10:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 22 → 24 → 26 → 27 → End (Org already collected)</li>
                        <li><strong>Path 11:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 22 → 24 → 26 → 28 → 29 → End (Org insufficient portions)</li>
                        <li><strong>Path 12:</strong> 1 → 2 → 3 → 5 → 6 → 8 → 9 → 11 → 13 → 22 → 24 → 26 → 28 → 30 → 31 → 32 → End (Org success)</li>
                        <li><strong>Path 13:</strong> Alternative edge coverage through decision nodes</li>
                    </ol>
                </div>
            </div>
        </div>

        <div style="page-break-before: always; margin-top: 40px;">
            <h2>Summary Table</h2>
            <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                <thead>
                    <tr style="background: #4CAF50; color: white;">
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Module</th>
                        <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">Cyclomatic Complexity</th>
                        <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">Number of Paths</th>
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Risk Level</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">Vendor Sign Up + License Upload</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">9</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">9</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">Moderate</td>
                    </tr>
                    <tr style="background: #f9f9f9;">
                        <td style="padding: 12px; border: 1px solid #ddd;">Create Food Listing (Vendor)</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">11</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">10</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">High</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">Consumer Scan QR + Collect Food</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">13</td>
                        <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">13</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">High</td>
                    </tr>
                </tbody>
            </table>
            
            <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-left: 4px solid #ffc107;">
                <h3 style="margin-top: 0;">Complexity Interpretation:</h3>
                <ul>
                    <li><strong>1-10:</strong> Simple module, low risk</li>
                    <li><strong>11-20:</strong> Moderate complexity, moderate risk</li>
                    <li><strong>21-50:</strong> Complex module, high risk</li>
                    <li><strong>50+:</strong> Very high complexity, very high risk</li>
                </ul>
                <p><strong>Recommendation:</strong> Modules with CC > 10 require thorough testing and potential refactoring for maintainability.</p>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>